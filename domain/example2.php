<?php
include('phpseclib/File/X509.php');

$certs = '-----BEGIN CERTIFICATE-----
MIIFXjCCA0agAwIBAgIBBDANBgkqhkiG9w0BAQsFADAfMR0wGwYDVQQDDBQuU2Vj
dXJlIFJvb3QgQ0EgMjAxNTAeFw0xNTAyMjAxNDQ4NTFaFw00NTAyMjAxNDQ4NTFa
MB8xHTAbBgNVBAMMFC5TZWN1cmUgSXNzdWluZyBDQSAxMIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAsAKpwyqT7jkFHP+34im2GOeAPsLKWTt7SQhWGhTF
KQxpVob4ngGaF5Zup3IC7CBi5MmFcKxTv1VWjbBtOU7PNmzxoCl8faZuWDKAXD8G
J/7Z07PzF9DDP8uiYbCttAQjxJJqcFVwsor/VR+LFpi0NsxjP/UNTLYbFidoKLY5
FdzPvZ82SVyJorERuaaZXvb6ZmuVZMfvMekANWcNX9tNdx1wvAqThtk6qiB2U4dy
ZMnGnLqUgDF7kL6IdsW7HMNG5GqiTrTiBnvkIwHFAWF0bN6TXt8JCCUcc7p5uOT9
yniVisJwK6+LyDlMuFvGrhOEm4TzvZHfegVmf/Nqz3Qb6m32+pmsyvKZ5AwpLpIQ
hMQJ2Ha9IPtNqjO4FI+aZTAt7kz5HPeetF2VDSeH5LhiKBeFujfpWqt4YExMOwdL
mUAbEM9M7SnfgIiZaNSRdXxkhL6veol9tTAIOX8TKQZh/cgZsonftk3JFlg6ytyu
7XtDGQnE7dq8xiJXhsdR4X/nZfagti/rCp7f+n2JtYgD5CXNHwVG0fHjbaht9v56
zdDucq8bUp61bPYBJGvMoIJ+DIn95/vq9XBmcU1DjEKffWn9sWflpAhSLGVWdfmU
TaQMprQxSdji8Hdu2j5lSnKN5MnVMwVW1lxI8ltrAu8ReQt4QQ2tUyNoPpJRru7/
CN8CAwEAAaOBpDCBoTALBgNVHQ8EBAMCAQYwDwYDVR0TAQH/BAUwAwEB/zAdBgNV
HQ4EFgQU4lZUJfimhlIHN6aCKF/10CEU0ckwQQYDVR0fBDowODA2oDSgMoYwaHR0
cDovL2NybC5TZWN1cmVPYnNjdXJlLmNvbS8/YWN0aW9uPWNybCZjYT1yb290MB8G
A1UdIwQYMBaAFGo6az6NV9j1vxWvcP+jSV5o0PGUMA0GCSqGSIb3DQEBCwUAA4IC
AQAbk/P7ioLsmhc0Y/n7OyuVe7+QxkHcqwD41AP2h14vicjfwA2MS/mQPCyazf14
ih7497H7o6yIHAAn74QJjeOJVaHlx7aTBnBSzSMWo1howOPE5M81N5QLYHKe4D3j
S9X1r5zfVs0q3/d9ol5kEvaAH7pjyuyrHANC7R0ft5a4K2NyGjUMVs8vpprnOiCb
qOWnFms6wx3Oo1C3wahRVvD9mTwyPKxircWcnDWDMhTw6QXzQV1NdIbP6dYpxjjJ
UnSrKuuv7doDNjeTJJ5g+fB8qEQWNwl6Ss2WhU3kaNbpugQ0YPjB05ajmBleEyzk
V8vbPRlHu4Zkrqn0e0kdPKABuwo5nb7U5TEw+sqVlPWBEwPnztb/t4Qq6Q8//0j/
riuRAQGAs7ioPzyKNC51G8kRgHbaiWArAD44ydb7was810PwhQ2duwAyDGRqGZB+
5LDYcUUOnqKDwo9jbV88khBN4QZj42wqsVlALEmmqPhUJKvCMpion1csBcJ5jLui
3DesfHn1wFD38/BVG1f6xrKNWQ01eZy+Yip+B39H0qodqHU2Rsjn7JPCqA5zHjoJ
bNcxZmcs3vBmVyVPcpx4x5NDOLUu6LAYgJ0yNDmb189X6gt0FJAGkBIrhOJyh/nz
s993S4YGqxrPpCUI0kTEJUhxIhYPP9b/s3WDIlbkVUpP/g==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFGTCCAwGgAwIBAgIBATANBgkqhkiG9w0BAQsFADAfMR0wGwYDVQQDDBQuU2Vj
dXJlIFJvb3QgQ0EgMjAxNTAeFw0xMjAyMjExNDM5MjVaFw00ODAyMjExNDM5MjVa
MB8xHTAbBgNVBAMMFC5TZWN1cmUgUm9vdCBDQSAyMDE1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAl+Z95uSw9PpsIo0U8u0XS45H/MNDsVmrMTsgglPh
Zt7eihcAHQqzGsR5q5zF7MCNLyf52xDQeXOiXdO/g/pmri+8cMOW2EbgMqFvH5HL
CwzVkO5S8QAzyqn0Tz0f7VkAJZv3zyoezete05rFc1zg/QznIHKUk4SqfEZiGMre
w/QLw649m5Q7xSYV2jBK4glp2szP81ZWe4/dcj4Bzx2ZWmReDTFeJ6kXchIQJT0S
vmUzjIwQ9s0reiTgAeSlxec0Ibm84C1y9gsqs001egYMc+WDpBVRNk+W/FzHPieD
1zLLRnQplvkGF92uV7qdVfeDiaMfgqxqFR9wC4q2c9nb760zKOMnG6CywsoNAdok
OPJr1DG9WA0cFJcvzVzu7tQUlt7PahOd77yuy2kJvI5PcJE0QjmJpsDOop5XHf4D
RqlIvrxyG4ePnsy4Hec007BcSMeHjrWwYE2aU1B+B0Cj6ntR+t3eIcbvwGeXkWI4
O01OniZre14sEPBI/wD3mZc8JtxBwr3sArJWL46Z5uRGihWMun2JSEIHObZYJp7n
oZzg4s30BaYovgZYIYA/6JHhPIDRd/tnSSQtzqVIE+WMocAEYmwW0/6SsRKeDy51
Ed2+TXMbVpb1k+ZNHTQa5i3FUvyWFDEiKKvcqRJuL5SAuv8J9h0DBr0FKrmObw2X
PdUCAwEAAaNgMF4wCwYDVR0PBAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0O
BBYEFGo6az6NV9j1vxWvcP+jSV5o0PGUMB8GA1UdIwQYMBaAFGo6az6NV9j1vxWv
cP+jSV5o0PGUMA0GCSqGSIb3DQEBCwUAA4ICAQBPO8zjkS4LqXKa20nSakBZge0q
UgEbPMJ6jE3TPcVFJwtsxb8EynMYuIQf+LqcPAG8wf7HzQc9X8YIza10E8w7t++H
j4FsxxMDWG8X9AwRKjSleE3+JWiyDk1pFCMPsoFDjmAcZWV2I7lq4N4kFqkhWNQM
rz4n05UsA775sg/ikHvu3VjwNVjtHB4CIeH0x3HxHsKlg4nCTkpcc8OgcYWlGfPu
rx0k22nzbwYpHXwS+nV19Ab0J/xWJjQK6SpPQXA/+ehokWuyKKLCRZ1E/2MpNy7j
3P9/K76ILr/ZEapNl6IygEi+8LcL+Q3ejxnphJRRCmrendFWThTS8Y5ha9GMqQNh
oC7Jn/uWItfgCGkad39m63wm6BNJ2grQ1P/J2yBumJyaUHE+xXDmgdfFW0VNwEyz
aYp0DUpXeylNJ5A2Dbcw8KGM2CTUWVg8K9KEJl+QjPbQ57gP8AmfFbVcoA3wzS3N
v7o1YhsilEDKtAVYPrN0YadgY3P3YSoUXHZpns11CWfFglC28WWBDa5c7SeSwSBF
4eH8VP45TpwtDUomMl8WDUg/yYiS/ATGGi16qkfMNxe8gXqRBJM6w4WYbJaRIhOj
frGzuJOMXnLuv6PjY/yQv0a68jHAftktj++IV3YpGR9RJnHCvTzR7O5BceRAteH6
q/Pr+MqghoTTo405PA==
-----END CERTIFICATE-----';
$certs = preg_split('#-+BEGIN CERTIFICATE-+#', $certs);
array_shift($certs);

$x509 = new File_X509();
for ($i = 0; $i < count($certs) - 1; $i++) {
    $x509->loadCA($certs[$i]);
}
$x509->loadX509($certs[count($certs) - 1]);
echo $x509->validateSignature() ? 'valid cert' : 'invalid cert';
?>